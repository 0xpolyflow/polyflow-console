<div class="flex flex-row gap-x-4 items-center mb-4">
    <div class="flex flex-row items-center transition-all cursor-pointer
    gap-x-2 uppercase font-semibold text-xs">
        <div routerLink="../"
            class="flex flex-row items-center bg-white gap-x-2 hover:text-white hover:bg-indigo-700 px-8 transition-all rounded-lg py-3">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M11.25 9l-3 3m0 0l3 3m-3-3h7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <div>Back</div>
        </div>

    </div>
    <div class="flex flex-row text-xs bg-white py-3 gap-x-2 rounded-lg px-6" *ngIf="session$ | async as session">
        <div class="uppercase font-semibold text-indigo-700">Session ID</div>
        <div class="text-slate-500">{{session.sessionId}}</div>
    </div>
</div>



<div class="w-full grid grid-cols-1 gap-4 mb-4" *ngIf="session$ | async as session">

    <div class="bg-white p-6 rounded-lg flex flex-col shadow-sm text-xs" *ngFor="let device of session.devices">

        <div class="flex flex-row gap-x-2 items-center uppercase mb-4 font-semibold text-indigo-700">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 002.25-2.25V6.75a2.25 2.25 0 00-2.25-2.25H6.75A2.25 2.25 0 004.5 6.75v10.5a2.25 2.25 0 002.25 2.25zm.75-12h9v9h-9v-9z" />
            </svg>
            <div>Session Metadata</div>
        </div>
        <div class="w-full grid grid-cols-5 gap-4 ">
            <div class="flex flex-col gap-y-1 border rounded-lg border-slate-100 px-4 py-2 text-center">
                <div class="font-semibold uppercase">Browser</div>
                <div>{{device.browser}}</div>
            </div>
            <div class="flex flex-col gap-y-1 border rounded-lg border-slate-100 px-4 py-2 text-center">
                <div class="font-semibold uppercase">OS</div>
                <div>{{device.os}}</div>
            </div>
            <div class="flex flex-col gap-y-1 border rounded-lg border-slate-100 px-4 py-2 text-center">
                <div class="font-semibold uppercase">Country</div>
                <div>{{device.country}}</div>
            </div>
            <div class="flex flex-col gap-y-1 border rounded-lg border-slate-100 px-4 py-2 text-center">
                <div class="font-semibold uppercase">Wallet Provider</div>
                <div>{{device.walletProvider}}</div>
            </div>
            <div class="flex flex-col gap-y-1 border rounded-lg border-slate-100 px-4 py-2 text-center">
                <div class="font-semibold uppercase">Screen Resolution</div>
                <div>{{device.screen?.w}} x {{device.screen?.h}}</div>
            </div>
        </div>

    </div>
    <ng-container *ngIf="session.walletAddresses as addresses">
        <div class="bg-white w-full flex flex-col p-6 rounded-lg text-xs shadow-sm" *ngIf="addresses.length > 0">
            <div class="uppercase font-semibold mb-4 text-indigo-700 flex flex-row gap-x-2 items-center">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                    stroke="currentColor" class="w-4 h-4">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3" />
                </svg>

                Addresses used in session
            </div>
            <div class="flex flex-row flex-wrap gap-2">
                <div class="mb-1 text-[11px] text-center font-medium text-indigo-500 py-3 px-5 bg-indigo-50 rounded-md"
                    *ngFor="let address of addresses">
                    {{address}}
                </div>
            </div>

        </div>
    </ng-container>

</div>


<div class="w-full bg-white p-8 rounded-lg shadow-sm text-xs">

    <div *ngIf="events$ | async as events">
        <div class="flex flex-row text-indigo-700 gap-x-2 items-center uppercase font-semibold text-xs mb-6">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
            </svg>
            <div>Session event history</div>
        </div>
        <div class="flex px-4 mb-2 text-xs flex-row uppercase font-semibold pb-2">
            <div class="w-1/12">
                Time
            </div>
            <div class="w-2/12 pl-4">
                Type
            </div>
            <div class="w-2/12 pl-4">
                Wallet
            </div>
            <div class="w-2/12">
                Network
            </div>
            <div class="w-2/12">
                Gas Balance
            </div>
            <div class="w-2/12">
                Wallet Activity Score
            </div>
        </div>
        <div class="flex flex-row w-full border-t hover:bg-slate-50 cursor-pointer border-slate-100"
            *ngFor="let event of events">

            <div class="w-full py-4 text-emerald-700 rounded-lg" *ngIf="event.tracker.eventTracker === 'USER_LANDED'">
                <div class="px-4 w-full flex flex-row items-center"
                    *ngIf="castToUserLandedEvent(event) as userLandedEvent">
                    <div class="w-1/12 text-slate-700 flex flex-col">
                        <div class="font-semibold">{{event.createdAtParsed.toLocaleDateString()}}</div>
                        <div class="text-xs">{{event.createdAtParsed.toLocaleTimeString()}}</div>
                    </div>
                    <div class="w-2/12  pl-4 uppercase text-[11px] font-semibold flex flex-row gap-x-2 items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-4 h-4">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0115 18.257V17.25m6-12V15a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 15V5.25m18 0A2.25 2.25 0 0018.75 3H5.25A2.25 2.25 0 003 5.25m18 0V12a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 12V5.25" />
                        </svg>

                        User Landed
                    </div>

                    <div class="w-2/12 pl-4 py-1 px-3 flex flex-row" *ngIf="userLandedEvent.userLandedWallet as wallet">
                        <div class="px-3 py-2 bg-emerald-50 font-medium rounded-md">
                            {{wallet.walletAddress | shorten:6:6}}
                        </div>

                    </div>
                    <div class="w-2/12 uppercase text-slate-700 font-medium flex flex-row gap-x-2"
                        *ngIf="userLandedEvent.userLandedNetwork as network">
                        <img class="h-4" src="../../../assets/networks/{{getNetwork(network.chainId)?.shortName}}.png"
                            alt="" srcset="">
                        {{getNetwork(network.chainId)?.name}}
                    </div>
                    <div class="w-2/12 text-slate-700 font-medium" *ngIf="userLandedEvent.userLandedWallet as wallet">
                        {{wallet.gasBalance}}
                    </div>
                    <div class="w-2/12 font-medium text-slate-700" *ngIf="userLandedEvent.userLandedWallet as wallet">
                        {{wallet.nonce}}
                    </div>
                </div>
            </div>
            <div class="w-full" *ngIf="event.tracker.eventTracker === 'WALLET_CONNECT'">
                <div class="px-4 w-full text-indigo-700
                 rounded-lg py-4 flex flex-row items-center"
                    *ngIf="castToWalletConnectedEvent(event) as walletConnectedEvent">
                    <div class="w-1/12 text-slate-700 flex flex-col">
                        <div class="font-semibold">{{event.createdAtParsed.toLocaleDateString()}}</div>
                        <div class="text-xs">{{event.createdAtParsed.toLocaleTimeString()}}</div>
                    </div>
                    <div class="w-2/12 text-[11px]  pl-4 font-semibold uppercase flex flex-row gap-x-2">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-4 h-4">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3" />
                        </svg>

                        Wallet Connected
                    </div>

                    <div class="w-2/12 text-xs pl-4 flex flex-row">
                        <div class="px-3 py-2 bg-indigo-50 rounded-md font-medium">
                            {{walletConnectedEvent.walletConnectedWallet.walletAddress | shorten:6:6}}
                        </div>
                    </div>
                    <div class="w-2/12 uppercase text-slate-700 font-medium flex flex-row gap-x-2"
                        *ngIf="walletConnectedEvent.walletConnectedNetwork as network">
                        <img class="h-4" src="../../../assets/networks/{{getNetwork(network.chainId)?.shortName}}.png"
                            alt="" srcset="">
                        {{getNetwork(network.chainId)?.name}}
                    </div>
                    <div class="w-2/12 text-slate-700 font-medium"
                        *ngIf="walletConnectedEvent.walletConnectedWallet as wallet">
                        {{wallet.gasBalance}}
                    </div>
                    <div class="w-2/12 font-medium text-slate-700"
                        *ngIf="walletConnectedEvent.walletConnectedWallet as wallet">
                        {{wallet.nonce}}
                    </div>
                </div>
            </div>
            <div class="w-full p-4 flex flex-row rounded-lg text-red-500"
                *ngIf="event.tracker.eventTracker === 'GENERIC_ERROR'">
                <div class="flex flex-row items-center w-full" *ngIf="castToErrorEvent(event) as errorEvent">
                    <div class="w-1/12 text-slate-700 flex flex-col">
                        <div class="font-semibold">{{event.createdAtParsed.toLocaleDateString()}}</div>
                        <div class="text-xs">{{event.createdAtParsed.toLocaleTimeString()}}</div>
                    </div>
                    <div class="w-2/12 text-[11px] flex flex-row  pl-4 items-center gap-x-2">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-4 h-4">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z" />
                        </svg>
                        <div class="font-semibold uppercase">Generic Error</div>
                    </div>

                    <div *ngIf="errorEvent.errorEventWallet?.walletAddress as address; else noAddress"
                        class="w-2/12 text-xs pl-4 flex flex-row items-center">
                        <div class="px-3 py-2 bg-red-50 rounded-md font-medium">
                            {{address | shorten:6:6}}
                        </div>
                    </div>
                    <div class="w-2/12 uppercase text-slate-700 font-medium flex flex-row gap-x-2"
                        *ngIf="errorEvent.errorEventNetwork as network">
                        <img class="h-4" src="../../../assets/networks/{{getNetwork(network.chainId)?.shortName}}.png"
                            alt="" srcset="">
                        {{getNetwork(network.chainId)?.name}}
                    </div>

                </div>
            </div>
        </div>

    </div>
</div>

<ng-template #noAddress>
    <div class="font-medium w-8/12 pl-4 bg-slate-50 text-slate-700 text-center py-2 rounded-md uppercase text-[11px]">
        User without wallet
    </div>
</ng-template>